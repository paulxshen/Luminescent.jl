{"version":3,"kind":"Notebook","sha256":"bb3438da150c4db812c351fa9703bf7828d10fd0aefb648f9bc7c70957232aeb","slug":"test-patch","location":"/test_patch.ipynb","dependencies":[],"frontmatter":{"title":"RF antenna: microstrip fed patch","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"base","language":"python"},"numbering":{"title":{"offset":2}},"exports":[{"format":"ipynb","filename":"test_patch.ipynb","url":"/test_patch-0357b02ddbafd8080f677ab9f503acf4.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We simulate a narrowband patch antenna fed by a microstrip line around 1.5 GHz. Compare with ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"DfCTcQtGQz"},{"type":"link","url":"https://www.comsol.com/model/microstrip-patch-antenna-11742","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"COMSOL example","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yVTbjslbd5"}],"urlSource":"https://www.comsol.com/model/microstrip-patch-antenna-11742","key":"FVafNh2VVI"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"fSzxZc1fKF"}],"key":"ZQI2XvJGRk"}],"key":"gLs3bg62ku"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# render movie","key":"ljH5pURdvs"},{"type":"outputs","id":"3bj2UKd4iic7oEExYQnO4","children":[],"key":"Dr3t1nGVw9"}],"key":"PaoJYTbQG0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Geometry","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q8LUdRdJ23"}],"identifier":"geometry","label":"Geometry","html_id":"geometry","implicit":true,"key":"UD2D5MRVCy"}],"key":"ItHuyevDXv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import luminescent as lumi\nfrom gdsfactory.technology import LogicalLayer, LayerLevel, LayerStack\nimport gdsfactory as gf\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport os\n\n# simulation folder\nname = \"microstrip_patch_antenna\"\npath = os.path.join(\"runs\", name)\n\n# length and frequency units are arbitrary but must be consistent. Here we use mm and GHz.\nfrequency = 1.55  # characteristic frequency in GHz\nfrequencies = np.linspace(1.45, 1.65, 101).tolist()\nwl1f = 300  # vacuum wavelength at 1 unit of frequency in your units\nwavelength = wl1f / frequency  # characteristic wavelength\n\n# microstrip patch [mm]\nd = 1.524 # sub depth\nw_line = 3.2 # 50 ohm line width\nw_patch = 53 # Patch width\nl_patch = 52 # Patch length\nw_slot = 7 # slot width\nl_flap = 15.5 # flap or slot length\nw_flap=w_patch/2-w_slot-w_line/2\nw_sub = 200 # sub width\nl_sub = 200 # sub length\nth=.1 # metal thickness\n\nlateral_port_margin = height_port_margin = 2*d\nsource_port_margin =  1.5*(w_line+2*lateral_port_margin)\nlx_mode = w_line + 2 * lateral_port_margin\nly_mode = th + height_port_margin + d\n\n# layers\nWG = 1, 0\nPATCH = 2, 0\nSUB= 3, 0\n\n# make geometry in gdsfadory\n# alternatively can import .gds into gdsfadory\n\nc = gf.Component()\n\nc.add_polygon(\n    [\n        (-l_patch / 2, -w_patch / 2),\n        (-l_patch / 2 + l_flap, -w_patch / 2),\n        (-l_patch / 2 + l_flap, -w_patch / 2 + w_flap),\n        (-l_patch / 2, -w_patch / 2 + w_flap),\n    ],\n    layer=PATCH,\n)\nc.add_polygon(\n    [\n        (-l_patch / 2, w_patch / 2),\n        (-l_patch / 2 + l_flap, w_patch / 2),\n        (-l_patch / 2 + l_flap, w_patch / 2 - w_flap),\n        (-l_patch / 2, w_patch / 2 - w_flap),\n    ],\n    layer=PATCH,\n)\nc.add_polygon(\n    [\n        (l_patch / 2, -w_patch / 2),\n        (-l_patch / 2 + l_flap, -w_patch / 2),\n        (-l_patch / 2 + l_flap, w_patch / 2),\n        (l_patch / 2, w_patch / 2),\n    ],\n    layer=PATCH,\n)\n\nc.add_polygon(\n    [\n        (-l_sub / 2, -w_sub / 2),\n        (-l_sub / 2, w_sub / 2),\n        (l_sub / 2, w_sub / 2),\n        (l_sub / 2, -w_sub / 2),\n    ],\n    layer=SUB,\n)\n\nline = c << gf.components.straight((l_sub - l_patch) / 2 + l_flap, width=w_line)\nline.movex(-l_sub / 2)\nc.add_port(\n    f\"o1\", center=(-l_patch / 2, 0), width=w_line, orientation=180, layer=WG\n)\n\nc.plot()","key":"z6IgyWIWQp"},{"type":"outputs","id":"EIAdBVBF1tVFbugM2BwRL","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c2dfa1059edff24b0674463116be140c","path":"/c2dfa1059edff24b0674463116be140c.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"wh9KlonZ68"}],"key":"hSLhVejEpY"}],"key":"oRBJ7PZKiB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Solve","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AktOu87Bl2"}],"identifier":"solve","label":"Solve","html_id":"solve","implicit":true,"key":"EENHRmMTJB"}],"key":"nNWquzcTrY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# adaptive meshing\nnres = 16 # points per wavelength in material\ndx0 = wavelength / nres  # mesh step in air\n\nlayer_stack = LayerStack(\n    layers={\n        \"patch\": LayerLevel(\n            layer=LogicalLayer(layer=PATCH),\n            zmin=0,\n            thickness=th,\n            material=\"PEC\",\n            mesh_order=1,\n        ),\n        \"line\": LayerLevel(\n            layer=LogicalLayer(layer=WG),\n            zmin=0,\n            thickness=th,\n            material=\"PEC_line\",\n            mesh_order=2,\n        ),\n        \"core\": LayerLevel(\n            layer=LogicalLayer(layer=SUB),\n            zmin=-d,\n            thickness=d,\n            material=\"sub\",\n            mesh_order=3,\n        ),\n    }\n)\n\ndx_line = w_line / 6  # 6 mesh points across the strip\ndx_patch = l_patch / 20  # 20 mesh points across the patch\n\neps_sub = 3.38\nn_sub = np.sqrt(eps_sub)\n\nmaterial_library = {\n    \"air\": lumi.Material(),\n    \"sub\": lumi.Material(epsilon=eps_sub),\n    \"PEC\": lumi.PECMaterial(mesh_density=dx0/dx_patch),\n    \"PEC_line\": lumi.PECMaterial(mesh_density=[n_sub, dx0/dx_line,1]),\n    'background': lumi.Material(),\n}\n\n# radiation port\nR=H = (w_sub) / 2\nangres=np.deg2rad(5)\nθmax=np.deg2rad(80) # avoid microstrip\nφmax=np.deg2rad(360)\nports = [\n    lumi.SpherePort(\n        name=\"o2\",\n        origin=(0, 0, 0),\n        radius=R,\n        angres=angres,\n        θmax=θmax,\n        φmax=φmax,\n    ),\n]\n\n# microstrip mode\n_dx = dx_line\n_dy = th\nmodes = [\n    lumi.Mode(\n        ports=[\"o1\"],\n        frequencies=lumi.chebyshev_nodes(frequencies[1], frequencies[-1], 5),\n        metallic_boundaries=[\"y-\", \"line\"],\n        nmodes=1,\n        start=[-lx_mode / 2, -d,],  # local xy frame, local y=0 at global zmin of port layer\n        stop=[lx_mode / 2, th + height_port_margin],\n        voltage_line=[(0, -d), (0, 0)],  # optional\n        current_loop=[\n            (-w_line / 2 - _dx, -_dy),\n            (-w_line / 2 - _dx, th + _dy),\n            (w_line / 2 + _dx, th + _dy),\n            (w_line / 2 + _dx, -_dy),\n        ],  # optional\n    )\n]\n\nsources = [\n    lumi.Source(\n        \"o1\", frequency=frequency, duration=1, source_port_margin=source_port_margin\n    ) # modulated Gaussian pulse\n]\n\n\nlumi.make(\n    path=path,  # path to make problem folder\n    name=name,\n    component=c,\n    frequencies=frequencies,\n    frequency=frequency,\n    wl1f=wl1f,\n    boundaries=[\"PML\", \"PML\", [\"PEC\", \"PML\"]],\n    #\n    ports=ports,\n    modes=modes,\n    sources=sources,\n    #\n    zmin=-d,\n    zmax=H,\n    #\n    material_library=material_library,\n    layer_stack=layer_stack,\n    #\n    gpu=\"CUDA\",\n    nres=nres,  # number of grid points per wavelength in material (not vacuum)\n    relative_courant=0.9,\n    field_decay_threshold=.001,  # stop when energy have decayed to this fraction of peak\n    saveat=.5,  # save frame every _ periods for plotting movie\n)\nlumi.solve(path)","key":"JiRLlqdquc"},{"type":"outputs","id":"fYGnNsSuwYs61U7_-PbU7","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"saving mode plots to runs\\microstrip_patch_antenna\\modes\\1\nshowing modes for first wavelength \nsolving modes with PEC boundaries\nSolving port modes with FEM...\n"},"children":[],"key":"ZOz5dunn6F"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"43e7172b08dd3e5add053113f439ee4f","path":"/43e7172b08dd3e5add053113f439ee4f.png"},"text/plain":{"content":"<Figure size 640x480 with 6 Axes>","content_type":"text/plain"}}},"children":[],"key":"a0vKrQ1YqY"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d830ec29673c31597502fdb8a93a78b6","path":"/d830ec29673c31597502fdb8a93a78b6.png"},"text/plain":{"content":"<Figure size 640x480 with 6 Axes>","content_type":"text/plain"}}},"children":[],"key":"UCmDTj8jkZ"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"c:\\Users\\default.LAPTOP-HMRU58MH\\anaconda3\\Lib\\site-packages\\skfem\\assembly\\form\\linear_form.py:44: ComplexWarning: Casting complex values to real discards the imaginary part\n  data[ixs] = self._kernel(vbasis.basis[i], w, dx)\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:616: ComplexWarning: Casting complex values to real discards the imaginary part\n  E = np.array(\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:629: ComplexWarning: Casting complex values to real discards the imaginary part\n  H = np.array(\n"},"children":[],"key":"RfVkNWQKKb"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"solving modes with PEC boundaries\nSolving port modes with FEM...\n"},"children":[],"key":"m1Lq46xqEn"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"c:\\Users\\default.LAPTOP-HMRU58MH\\anaconda3\\Lib\\site-packages\\skfem\\assembly\\form\\linear_form.py:44: ComplexWarning: Casting complex values to real discards the imaginary part\n  data[ixs] = self._kernel(vbasis.basis[i], w, dx)\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:616: ComplexWarning: Casting complex values to real discards the imaginary part\n  E = np.array(\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:629: ComplexWarning: Casting complex values to real discards the imaginary part\n  H = np.array(\n"},"children":[],"key":"duwvPRFrKA"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"solving modes with PEC boundaries\nSolving port modes with FEM...\n"},"children":[],"key":"vm7luwBseh"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"c:\\Users\\default.LAPTOP-HMRU58MH\\anaconda3\\Lib\\site-packages\\skfem\\assembly\\form\\linear_form.py:44: ComplexWarning: Casting complex values to real discards the imaginary part\n  data[ixs] = self._kernel(vbasis.basis[i], w, dx)\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:616: ComplexWarning: Casting complex values to real discards the imaginary part\n  E = np.array(\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:629: ComplexWarning: Casting complex values to real discards the imaginary part\n  H = np.array(\n"},"children":[],"key":"x4ccNtpwvG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"solving modes with PEC boundaries\nSolving port modes with FEM...\n"},"children":[],"key":"qKKh3eKBTq"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"c:\\Users\\default.LAPTOP-HMRU58MH\\anaconda3\\Lib\\site-packages\\skfem\\assembly\\form\\linear_form.py:44: ComplexWarning: Casting complex values to real discards the imaginary part\n  data[ixs] = self._kernel(vbasis.basis[i], w, dx)\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:616: ComplexWarning: Casting complex values to real discards the imaginary part\n  E = np.array(\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:629: ComplexWarning: Casting complex values to real discards the imaginary part\n  H = np.array(\n"},"children":[],"key":"KVekQZZFNH"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"solving modes with PEC boundaries\nSolving port modes with FEM...\n"},"children":[],"key":"P51nAhmex0"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"c:\\Users\\default.LAPTOP-HMRU58MH\\anaconda3\\Lib\\site-packages\\skfem\\assembly\\form\\linear_form.py:44: ComplexWarning: Casting complex values to real discards the imaginary part\n  data[ixs] = self._kernel(vbasis.basis[i], w, dx)\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:616: ComplexWarning: Casting complex values to real discards the imaginary part\n  E = np.array(\nc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:629: ComplexWarning: Casting complex values to real discards the imaginary part\n  H = np.array(\n"},"children":[],"key":"Qie6tF6cuz"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"using simulation folder C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\microstrip_patch_antenna\n1.3\n1.3\n1.3\n6.048387096774193\n3.2898888702848055\nloading problem from C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\microstrip_patch_antenna\n========================================\n\ncan't find fdtd binary \n"},"children":[],"key":"iBj7mUCch7"}],"key":"NnQ3VZRAzQ"}],"key":"Me2iQ2cGS1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jq9BQ99iCQ"}],"identifier":"visualize","label":"Visualize","html_id":"visualize","implicit":true,"key":"JPWrHvBM81"}],"key":"UreZ7ijn14"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"material_color_map={\n        'background':'transparent',\n        'sub':('yellow',.5),\n        'PEC':('black',.5), # (color, alpha)\n}\nviews=[\n        lumi.View(\"Ex\", z=th / 2,  field_color_intensity=10,material_color_map=material_color_map,material_library=material_library),\n        # lumi.View(\"Ez\", z=-d / 2,  field_color_intensity=10,material_color_map=material_color_map,material_library=material_library),\n    ]\nlumi.peek(path, views) # snapshots at halfway and final time step","key":"MzzVtwJSi8"},{"type":"outputs","id":"WYxQm2shFxe8osZGvodT5","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"========================================\n\nfailed plotting new frames\n"},"children":[],"key":"QoKJlUIY6s"}],"key":"pifqQPaEml"}],"key":"fARsRi4xtL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lumi.movie(path, views) # full movie - this may take a while to render","key":"lTmgeErs3W"},{"type":"outputs","id":"Y5YVNJRXEpRcSiNkCZRV9","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"========================================\n\nfailed plotting new frames\n"},"children":[],"key":"ZvE0JzBRK2"},{"type":"output","jupyter_data":{"ename":"IndexError","evalue":"list index out of range","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mIndexError\u001b[39m                                Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[13]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m lumi.movie(path, views)\n\n\u001b[36mFile \u001b[39m\u001b[32mc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:841\u001b[39m, in \u001b[36mmovie\u001b[39m\u001b[34m(path, views, fps)\u001b[39m\n\u001b[32m    823\u001b[39m \u001b[38;5;66;03m# # Set frame from the first image\u001b[39;00m\n\u001b[32m    824\u001b[39m \u001b[38;5;66;03m# frame = cv2.imread(os.path.join(frames_folder, images[0]))\u001b[39;00m\n\u001b[32m    825\u001b[39m \u001b[38;5;66;03m# height, width, layers = frame.shape\u001b[39;00m\n\u001b[32m   (...)\u001b[39m\u001b[32m    837\u001b[39m \u001b[38;5;66;03m# video.release()\u001b[39;00m\n\u001b[32m    838\u001b[39m \u001b[38;5;66;03m# cv2.destroyAllWindows()\u001b[39;00m\n\u001b[32m    840\u001b[39m GIF = os.path.abspath(os.path.join(path, \u001b[33m\"\u001b[39m\u001b[33msimulation.gif\u001b[39m\u001b[33m\"\u001b[39m))\n\u001b[32m--> \u001b[39m\u001b[32m841\u001b[39m create_gif(frames_folder, GIF, \u001b[32m1000\u001b[39m / fps)\n\u001b[32m    842\u001b[39m \u001b[38;5;28mprint\u001b[39m(\u001b[33mf\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mVideo generated successfully at \u001b[39m\u001b[38;5;132;01m{\u001b[39;00mGIF\u001b[38;5;132;01m}\u001b[39;00m\u001b[33m!\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m    843\u001b[39m display(Image(filename=os.path.join(path, \u001b[33m\"\u001b[39m\u001b[33msimulation.gif\u001b[39m\u001b[33m\"\u001b[39m)))\n\n\u001b[36mFile \u001b[39m\u001b[32mc:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\luminescent\\utils.py:733\u001b[39m, in \u001b[36mcreate_gif\u001b[39m\u001b[34m(image_path, output_path, duration)\u001b[39m\n\u001b[32m    730\u001b[39m     \u001b[38;5;28;01mif\u001b[39;00m frames[i].mode != \u001b[33m\"\u001b[39m\u001b[33mRGB\u001b[39m\u001b[33m\"\u001b[39m:\n\u001b[32m    731\u001b[39m         frames[i] = frames[i].convert(\u001b[33m\"\u001b[39m\u001b[33mRGB\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m--> \u001b[39m\u001b[32m733\u001b[39m frames[\u001b[32m0\u001b[39m].save(\n\u001b[32m    734\u001b[39m     output_path,\n\u001b[32m    735\u001b[39m     save_all=\u001b[38;5;28;01mTrue\u001b[39;00m,\n\u001b[32m    736\u001b[39m     append_images=frames[\u001b[32m1\u001b[39m:],\n\u001b[32m    737\u001b[39m     duration=duration,\n\u001b[32m    738\u001b[39m     loop=\u001b[32m0\u001b[39m,  \u001b[38;5;66;03m# 0 means infinite loop\u001b[39;00m\n\u001b[32m    739\u001b[39m )\n\n\u001b[31mIndexError\u001b[39m: list index out of range"},"children":[],"key":"KTNL37XEuv"}],"key":"AOVrEKAMu6"}],"key":"Eg27uOvr6T"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analysis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MVPHXJSsXd"}],"identifier":"analysis","label":"Analysis","html_id":"analysis","implicit":true,"key":"CUiSDZHlm3"}],"key":"pJiPVhkZKk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sol = lumi.load(path)\n\n# S11 plot\nfig = plt.figure()\nx = frequencies\ny = [10 * np.log10(v) for v in lumi.query(sol, \"T1,1\")]\n# y = [10 * math.log10(v) for v in lumi.query(sol, \"To2@0,o1@0\")]\n\nplt.plot(x, y)\nplt.xlabel(\"f [GHz]\")\nplt.ylabel(\"S11 [dB]\")\nplt.show()\n\nflux = sol[\"dBi\"][\"o2\"] # can append after o2 @H, V, L or R for polarization\ni = np.argmin(y)\nnφ = round(φmax / angres) + 1\nnθ = round(θmax / angres) + 1\nθ = np.linspace(0, θmax, nθ)\n\n# Radiation pattern plots\nflux_E_plane1 = flux[:, 0, i]\nflux_E_plane2 = flux[:, round((nφ - 1) / 2), i]\n\nflux_H_plane1 = flux[:, round((nφ - 1) / 4), i]\nflux_H_plane2 = flux[:, round((nφ - 1) / 4 * 3), i]\n\nfig = plt.figure()\n\nax = fig.add_subplot(121, polar=True)\nax.set_theta_zero_location(\"N\")\nax.set_theta_direction(\"clockwise\")\nax.plot(θ, flux_E_plane1)\nax.plot(-θ, flux_E_plane2)\nax.set_title(\"E-Plane Radiation Pattern\")\nax.set_ylim(-30, 30)\n\nax = fig.add_subplot(122, polar=True)\nax.set_theta_zero_location(\"N\")\nax.set_theta_direction(\"clockwise\")\nax.plot(θ, flux_H_plane1)\nax.plot(-θ, flux_H_plane2)\nax.set_ylim(-30, 30)\nax.set_title(\"H-Plane Radiation Pattern\")","key":"fOeXjxOgEf"},{"type":"outputs","id":"K3vgp4AF2I9o_iJjkRAYS","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"loading solution from C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\microstrip_patch_antenna\n"},"children":[],"key":"xFSxmpXXcH"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ee16901edcb10f6b237bfe698ca14ac7","path":"/ee16901edcb10f6b237bfe698ca14ac7.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"WERQoCJsrg"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"35ac62fa3c75afe508c8cebb2fd0a324","path":"/35ac62fa3c75afe508c8cebb2fd0a324.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"WDZ9B8mAco"}],"key":"W0i0h2DiuU"}],"key":"BVed4seLr3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y=Z0 = 377 * sol[\"Z\"][\"o1\"]\nplt.plot(x, np.real(y), label=\"Real\", color=\"orange\")\nplt.plot(x, np.imag(y), label=\"Imaginary\", color=\"blue\")\nplt.xlabel(\"f [GHz]\")\nplt.ylabel(\"complex line impedance [Ohms]\")\nplt.legend()\nplt.show()","key":"j3loR7BVRH"},{"type":"outputs","id":"YDA7ZyqrD5koJNNDc9KoE","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"edaa1f1ed5e3d2e40e6ecf861bf507bf","path":"/edaa1f1ed5e3d2e40e6ecf861bf507bf.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"QMtSBkapOA"}],"key":"tSQOIjF7Ny"}],"key":"qUoyxsSr4L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"S11=sol['waves']['o1@0+']/sol['waves']['o1@0-']\ny=Za=Z0*(1+S11)/(1-S11)\n\nplt.plot(x, np.real(y), label=\"Real\", color=\"orange\")\nplt.plot(x, np.imag(y), label=\"Imaginary\", color=\"blue\")\nplt.xlabel(\"f [GHz]\")\nplt.ylabel(\"antenna impedance [Ohms]\")\nplt.legend()\nplt.show()","key":"VlAzPdZOP2"},{"type":"outputs","id":"tWp3eMc5sKPx_NdjXitWF","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4db3f1b3d2796528f7b1ff8a3cfe52b7","path":"/4db3f1b3d2796528f7b1ff8a3cfe52b7.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"udGxEq5CZc"}],"key":"xvZGgzEjhC"}],"key":"Nrj1t7xjKs"}],"key":"Ssf8PdHbxG"},"references":{"cite":{"order":[],"data":{}}}}