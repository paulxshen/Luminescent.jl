{"version":3,"kind":"Notebook","sha256":"fc693afa36f32869e0d31073d7e5ecc468aab56f17164dfe36d05ae715fd5390","slug":"test-fss","location":"/test_FSS.ipynb","dependencies":[],"frontmatter":{"title":"Metasurface: microwave frequency selective surface (FSS)","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"base","language":"python"},"numbering":{"title":{"offset":2}},"exports":[{"format":"ipynb","filename":"test_FSS.ipynb","url":"/test_FSS-45c6336c5af5c64807b02f59a12e572e.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KsM1vE6VLS"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"zAlJop8dbN"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We simulate microwave frequency selective surface (FSS) with 12GHz bandstop. periodic Metal cross array on dielectric substrate. Compare with Tidy3D example ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"p4hfwdbNL1"},{"type":"link","url":"https://www.flexcompute.com/tidy3d/examples/notebooks/MicrowaveFrequencySelectiveSurface","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"https://​www​.flexcompute​.com​/tidy3d​/examples​/notebooks​/MicrowaveFrequencySelectiveSurface","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"zdmcvCbanw"}],"urlSource":"https://www.flexcompute.com/tidy3d/examples/notebooks/MicrowaveFrequencySelectiveSurface","key":"sMPjK0cIXB"}],"key":"J1I2N3TlDr"}],"key":"kPa3MT5tk1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Geometry","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EV6VlMniKG"}],"identifier":"geometry","label":"Geometry","html_id":"geometry","implicit":true,"key":"MPOuTkXpIS"}],"key":"sduusRiRvR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import luminescent as lumi\nfrom gdsfactory.technology import LogicalLayer, LayerLevel, LayerStack\nimport gdsfactory as gf\nimport math\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\n\nname = \"microwave_frequency_selective_surface\"\npath = os.path.join(\"runs\", name)\n\n# length and frequency units are arbitrary\nfrequency = 12  # origin frequency GHz\nbw = 4  # bandwidth\ndf = 0.05  # frequency step\nwl1f = 300  # vacuum wavelength at 1 unit of frequency in your units\nwl = wl1f / frequency  # characteristic wavelength\nfrequencies = np.linspace(frequency-bw/2, frequency+bw/2, round(bw/df+1))\n\n# unit cell [mm]\nP = 15  # periodicity\nL = 9.4  # length of cross\nW = 2.0  # width of cross stub\nd = 2.2  # height of substrate\nth = 0.1  # metal thickness\ngap = 15.0  # air gap below and above - keeps resonant evanescent field from coupling to lossy PML\nmargin = 2.0\n\n# adaptive meshing\nnres = 16\ndx0 = wl / nres\nmesh_density = dx0 / 0.5\n\n# material_library\nmaterial_library = lumi.MATERIAL_LIBRARY\nmaterial_library[\"sub\"] = lumi.Material(epsilon=2.5, mesh_density=mesh_density)\nmaterial_library[\"PEC\"] = lumi.PECMaterial(mesh_density=mesh_density)\n\n# make geometry in gdsfactory. 1/4 section of unit cell due to symmetry\n# alternatively can import .gds into gdsfactory\n\nWG = (1, 0)\nBBOX = (2, 0)\n\nlayer_stack = LayerStack(\n    layers={\n        \"WG\": LayerLevel(\n            layer=LogicalLayer(layer=WG),\n            thickness=th,\n            zmin=0,\n            material=\"PEC\",\n            mesh_order=1,\n        ),\n        \"sub\": LayerLevel(\n            layer=LogicalLayer(layer=BBOX),\n            thickness=d,\n            zmin=-d,\n            material=\"sub\",\n            mesh_order=2,\n        ),\n    }\n)\n\nc = gf.Component()\nc.add_polygon(\n    [(0, 0), (0, L / 2), (W / 2, L / 2), (W / 2, 0)],\n    layer=WG,\n)\np = c.add_polygon(\n    [(W / 2, W / 2), (W / 2, 0), (L / 2, 0), (L / 2, W / 2)],\n    layer=WG,\n)\nc.add_polygon([(0, 0), (0, P / 2), (P / 2, P / 2), (P / 2, 0)], layer=BBOX)\nc.plot()","key":"I399dKZjEn"},{"type":"outputs","id":"PwyxqIof1NvK3OrlJHkU9","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"running luminescent python frontend\n"},"children":[],"key":"J2RC5hpEIS"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"95ea19000a80452a96c1b9c08dcaf031","path":"/95ea19000a80452a96c1b9c08dcaf031.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"jwFvO3YOM4"}],"key":"JJwXd3CWSi"}],"key":"RWrKIMDntQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Solve","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b9FL9oDtz9"}],"identifier":"solve","label":"Solve","html_id":"solve","implicit":true,"key":"JJPNVYG2MP"}],"key":"byxLLA9pHd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ports = [\n    lumi.PlanePort(name=\"o1\", z=th + gap, direction=\"+\"),\n    lumi.PlanePort(name=\"o2\", z=-d-gap, direction=\"-\"),\n]\nmodes = [lumi.Mode(frequencies=[frequency],fields=[[{\"Ex\": 1, \"Hy\": 1},{\"Ey\": 1, \"Hx\": -1}]])]\nsources = [lumi.Source(\"o1\", source_port_margin=margin, frequency=frequency, bandwidth=bw)]\n\nlumi.make(\n    path,\n    name=name,\n    component=c,\n    frequencies=frequencies,\n    wl1f=wl1f,\n    # antisymmetric/PEC/odd vs symmetric/PMC/even symmetry\n    boundaries=[\"PEC\", \"PMC\", \"PML\"],\n    #\n    sources=sources,\n    ports=ports,\n    modes=modes,\n    zmin=-gap-d,\n    zmax= th + gap + margin,\n    #\n    material_library=material_library,\n    layer_stack=layer_stack,\n    #\n    gpu=\"CUDA\",  # use GPU acceleration\n    relative_courant=0.9,  # relative courant number between 0 and 1\n    nres=nres,\n    Tsim=50,  # max time [periods]\n    field_decay_threshold=0.003,  # field decay threshold for stopping simulation\n    saveat=0.25,\n)\nlumi.solve(path)","key":"cprbMSameC"},{"type":"outputs","id":"HbpvXekr9MvyYTAoA4XYN","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"saving mode plots to runs\\microwave_frequency_selective_surface\\modes\\1\nusing simulation folder c:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\microwave_frequency_selective_surface\n0.25\n0.25\n0.25\nloading problem from C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\microwave_frequency_selective_surface\n========================================\n\ncan't find fdtd binary \n"},"children":[],"key":"EoUhDPF1QE"}],"key":"m0cvLk5KiQ"}],"key":"MVQrjA2WVO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"views=[lumi.View('Ex',x=0,y=0,z=th/2)]\nlumi.movie(path, views)","key":"mmmamCV9rh"},{"type":"outputs","id":"qGD_9U5KC0HiMbgVKWBhK","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"========================================\n\nfailed plotting new frames\nVideo generated successfully at C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\microwave_frequency_selective_surface\\simulation.gif!\n"},"children":[],"key":"m14iFGlgwf"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/gif":{"content_type":"image/gif","hash":"1ab633708e32fe2ab0e8fb8e83621364","path":"/1ab633708e32fe2ab0e8fb8e83621364.gif"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"i5STxYfoeW"}],"key":"K2cjjcWHQX"}],"key":"YTEU4ptG4l"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Analysis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pstiMTVRhf"}],"identifier":"analysis","label":"Analysis","html_id":"analysis","implicit":true,"key":"joSKcibIiC"}],"key":"ivB13qJ9ml"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sol = lumi.load(path)\nx = frequencies\ny = [10 * math.log10(x) for x in lumi.query(sol,'T2,1')]\nplt.plot(x, y)\nplt.xlabel(\"f [GHz]\")\nplt.ylabel(\"S21 [dB]\")\nplt.show()","key":"LVguvqIqII"},{"type":"outputs","id":"QzeDOnWL1M8--0NNrSnBm","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"loading solution from c:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\FSS\n"},"children":[],"key":"waUlshftlK"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8721e315891d7d7d09d74ec6fa241625","path":"/8721e315891d7d7d09d74ec6fa241625.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"nhtt9tAe6L"}],"key":"d0plTLmEfb"}],"key":"rE9RSsx3GF"}],"key":"NKFThXpiaO"},"references":{"cite":{"order":[],"data":{}}}}