{"version":3,"kind":"Notebook","sha256":"16b249b67042fa208cf9af3f2a6b4fb1c49ddce075c7b3dd71935a2afc179f5c","slug":"test-bend","location":"/test_bend.ipynb","dependencies":[],"frontmatter":{"title":"Photonic waveguide bend","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"base","language":"python"},"numbering":{"title":{"offset":2}},"exports":[{"format":"ipynb","filename":"test_bend.ipynb","url":"/test_bend-af198621f453390c6fe1f053b52ca4d3.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We compute wavelength dependent S-parameters for a photonic waveguide bend in SOI","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Y7Io1mOQGE"}],"key":"E6va4sSjvw"}],"key":"jWxNgnczYv"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Geometry","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XRJ3FURpoQ"}],"identifier":"geometry","label":"Geometry","html_id":"geometry","implicit":true,"key":"t8MR0VELio"}],"key":"FMztPRa2Kx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import luminescent as lumi\nfrom gdsfactory.technology import LogicalLayer, LayerLevel, LayerStack\nimport gdsfactory as gf\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\n\n# simulation folder\nname='photonic_waveguide_bend'\npath = os.path.join(\"runs\", name)\n\n# length units are arbitrary so long as they're consistent\nwavelength = 1.55 # characteristic wavelength in microns\nwavelengths = np.linspace(1.4, 1.7, 81)\nd = 0.22\nw_wg = 0.5\n\n# layers\nWG = 1, 0\nCLAD = 2, 0\n\n# margins\nlateral_port_margin = height_port_margin = 0.6\nxmargin = 1.25 * lateral_port_margin\nzmargin = 1.25 * height_port_margin\nsource_port_margin = 2 * (w_wg + 2 * lateral_port_margin)\n\n# make component in gdsfactory. alternatively can import .gds into gdsfactory\nc = gf.Component()\n\ndut = c << gf.components.bend_circular(5)\next = c << gf.components.straight(length=source_port_margin)\next.connect(\"o2\", dut.ports[\"o1\"])\n\nc << gf.components.bbox(component=c, layer=CLAD, right=xmargin, bottom=xmargin)\n\nc.add_port(\"o1\", port=dut.ports[\"o1\"])\nc.add_port(\"o2\", port=dut.ports[\"o2\"])  # thru channel\nc.plot()","key":"IMT72xbSAZ"},{"type":"outputs","id":"bYr_X1KABDSVrjEu0mgv0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"running luminescent python frontend\n"},"children":[],"key":"f6PHwvySeD"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9e1062036857d3a760ff756755834046","path":"/9e1062036857d3a760ff756755834046.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"HAyMrYC2WA"}],"key":"owYOL9ydd3"}],"key":"ObTarDSx06"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Solve","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y2xlZmvaZ5"}],"identifier":"solve","label":"Solve","html_id":"solve","implicit":true,"key":"z8BYG1YuMd"}],"key":"W9u7JiZ8RA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"nres = 6  # number of grid points per wavelength in material (not vacuum)\n\nlx = w_wg + 2 * lateral_port_margin\nly = d + 2 * height_port_margin\nmodes = [\n    lumi.Mode(\n        ports=[\"o1\", \"o2\"],\n        wavelengths=lumi.chebyshev_nodes(wavelengths[0], wavelengths[-1],7),\n        start=[-lx / 2, -height_port_margin],  # local xy frame, local y=0 at global zmin of port layer\n        stop=[lx / 2, d + height_port_margin],\n    )\n]\n\nmaterial_library = {\n    \"Si\": lumi.Material(\n        epsilon=12.25,\n        # sigma=0.001,\n        # chi2=0.001,\n        # chi3=0.001,\n        # dispersion=[(0.001, 0.001, True)],\n    ),\n    \"SiO2\": lumi.Material(epsilon=2.25),\n}\nmaterial_library[\"background\"] = material_library[\"SiO2\"]  # set background material\n\nlayer_stack = LayerStack(\n    layers={\n        \"core\": LayerLevel(\n            layer=LogicalLayer(layer=WG),\n            thickness=d,\n            zmin=0.0,\n            material=\"Si\",\n            mesh_order=1,\n        ),\n    }\n)\n\nsources = [\n    lumi.Source(\n        \"o1\",\n        wavelength=wavelength,\n        source_port_margin=source_port_margin,\n        bandwidth=0.2,\n    )\n]\n\nlumi.make(\n    path=path,  \n    name=name,\n    component=c,\n    modes=modes,\n    wavelengths=wavelengths,\n    sources=sources,  # launch into port \"1\"\n    #\n    zmin=-zmargin,\n    zmax=d + zmargin,\n    #\n    material_library=material_library,\n    layer_stack=layer_stack,\n    #\n    gpu=\"CUDA\",  # use GPU acceleration\n    nres=nres,\n    field_decay_threshold=0.0001,  # field decay threshold for stopping simulation\n    relative_pml_depths=[1, 1, 0.3],  # relative PML thes in x, y, z\n    relative_courant=0.9,\n    saveat=10,\n)","key":"TSNSmwL1si"},{"type":"outputs","id":"5aQgKdhn9xZrfH7tHwVDB","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"saving mode plots to runs\\photonic_waveguide_bend\\modes\\1\nshowing modes for first wavelength \nusing simulation folder c:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\photonic_waveguide_bend\n0.0369047619047619\n0.0369047619047619\n"},"children":[],"key":"kW3Bgmw9mM"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b556c20bdbf3862b3d4ba635edb9ad34","path":"/b556c20bdbf3862b3d4ba635edb9ad34.png"},"text/plain":{"content":"<Figure size 640x480 with 6 Axes>","content_type":"text/plain"}}},"children":[],"key":"fgJdsHMGoY"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1d19f95d75c18f9aa511941ec2083278","path":"/1d19f95d75c18f9aa511941ec2083278.png"},"text/plain":{"content":"<Figure size 640x480 with 6 Axes>","content_type":"text/plain"}}},"children":[],"key":"DrZv84L3ol"}],"key":"EOplswVn1o"}],"key":"ejD5ug9AzY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lumi.solve(path)","key":"Kv62ZRUpR9"},{"type":"outputs","id":"g7D2QI__JRhqw4D2dQUdQ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"loading problem from C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\photonic_waveguide_bend\n========================================\n\ncan't find fdtd binary \n"},"children":[],"key":"zKsTzTvVsU"}],"key":"EhlRWcwAkX"}],"key":"JOr7ONEv7z"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EkZ0fAt2aI"}],"identifier":"visualize","label":"Visualize","html_id":"visualize","implicit":true,"key":"fJ36n4ZbTk"}],"key":"uP7w5rum0e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"views=[lumi.View(\"Hz\")]\nlumi.peek(path,views)","key":"f1nahqY8rD"},{"type":"outputs","id":"Le1LvgIrvuzIbnoxzEMu9","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"========================================\n\nfailed plotting new frames\n"},"children":[],"key":"Fwm0Tap52O"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b030f1c811a44655588ca75159510c2b","path":"/b030f1c811a44655588ca75159510c2b.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"qwSSXXNN2U"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ae8f8eaeffe4dd69e8cdab8514a74d0b","path":"/ae8f8eaeffe4dd69e8cdab8514a74d0b.png"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"DX0TjMBfWI"}],"key":"xni4ASJ8cd"}],"key":"ESYttobBMU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"lumi.movie(path,views)","key":"kOqYuLkynk"},{"type":"outputs","id":"m-ZkO2Lcup17CtLA4HpJX","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"========================================\n\nfailed plotting new frames\nVideo generated successfully at C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\photonic_waveguide_bend\\simulation.gif!\n"},"children":[],"key":"HwSa33F7Os"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/gif":{"content_type":"image/gif","hash":"813d5ad7c39fb392c8bd3d29c743b09f","path":"/813d5ad7c39fb392c8bd3d29c743b09f.gif"},"text/plain":{"content":"<IPython.core.display.Image object>","content_type":"text/plain"}}},"children":[],"key":"Y1cZyeRRvX"}],"key":"YxJfyoIdvD"}],"key":"Af0nlBEr9i"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Results","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n5oMUesaYc"}],"identifier":"results","label":"Results","html_id":"results","implicit":true,"key":"tMUgpWNBLf"}],"key":"VAG28dycyL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.close()\nsol = lumi.load(path)\nx = wavelengths\n\ny = lumi.query(sol, \"To2@0,o1@0\")  # wavelength or frequency ordered depending on problem setup\ny = lumi.query(sol, \"T2,1\")\n# y=np.abs2(sol['waves']['o3@0']/sol['waves']['o1@0'])\n\n# y=[10*np.log10(y) for y in y]\n\nplt.plot(x, y)\nplt.xlabel(\"wavelength [um]\")\nplt.ylabel(\"T21 power transmission\")\nplt.show()","key":"uXvVzlnzjc"},{"type":"outputs","id":"hmGGj3WH-a4i7MdiMr8e0","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"loading solution from C:\\Users\\default.LAPTOP-HMRU58MH\\Desktop\\lumi\\luminescent\\runs\\photonic_waveguide_bend\n"},"children":[],"key":"A0vXeQqCDj"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"53d0f9f8cbf92296a6b79226aac4adc7","path":"/53d0f9f8cbf92296a6b79226aac4adc7.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Zi8dpwEhxz"}],"key":"cP6qnYIpgb"}],"key":"IIbuZkstej"}],"key":"rmAktnRZCR"},"references":{"cite":{"order":[],"data":{}}}}